<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/font-awesome/css/all.css"/>
    <link rel="stylesheet" type="text/css" href="/css/style.css">

    <title th:text="#{title.requests}">Requests</title>
</head>

<body>
<nav th:insert="navbar :: usernavbar"></nav>

<div th:insert="sidebar :: sidebaradmin"></div>

<main class="content">
    <br>
    <div class="container">

        <div th:switch="${requests.empty}">
            <div th:case="true">
                <div th:text="#{list.empty}" class="alert alert-dark" role="alert"></div>
            </div>
            <div th:case="false">
                <table class="table">
                    <thead class="thead-light">
                    <tr>
                        <th th:text="#{show.user.name}">User</th>
                        <th th:text="#{show.book.name}">Book Name</th>
                        <th th:text="#{show.book.author}">Author</th>
                        <th th:text="#{req.date}">Request Date</th>
                        <th th:text="#{req.status}">Status</th>
                        <th th:text="#{show.book.actions}">Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="req: ${requests}">
                        <td th:text="${req.userEmail}"></td>
                        <td th:text="${req.name}"></td>
                        <td th:text="${req.authorName}"></td>
                        <td th:text="${req.requestDate}"></td>
                        <td>
                            <th:block th:switch="${req.approved}">
                                <div th:case="null"><span class="text-info" th:text="#{req.status.new}"></span>
                                </div>
                                <div th:case="true"><span class="text-success"
                                                          th:text="#{req.status.accepted}"></span>
                                </div>
                                <div th:case="false"><span class="text-danger"
                                                           th:text="#{req.status.declined}"></span>
                                </div>
                            </th:block>
                        </td>
                        <td>
                            <th:block th:switch="${req.approved}">
                                <div th:case="null" class="button-form">
                                    <form th:action="@{/admin/approve/{id}(id=${req.id})}" th:object="${action}"
                                          method="post">
                                        <input type="hidden" name="action" th:id="action" th:value="true">
                                        <button type="submit" class="btn btn-success btn-small">
                                            <i class="fa fa-check"></i>
                                        </button>
                                    </form>

                                    <form th:action="@{/admin/approve/{id}(id=${req.id})}" th:object="${action}"
                                          method="post">
                                        <input type="hidden" name="action" th:id="action" th:value="false">
                                        <button type="submit" class="btn btn-danger btn-small">
                                            <i class="fa fa-times"></i>
                                        </button>
                                    </form>
                                </div>
                                <div th:case="true">
                                    <span class="text-muted" th:text="#{req.action.no}"></span>
                                </div>
                                <div th:case="false">
                                    <span class="text-muted" th:text="#{req.action.no}"></span>
                                </div>
                            </th:block>

                        </td>
                    </tr>
                    </tbody>
                </table>

                <nav th:if="${requests.totalPages > 1}">
                    <ul class="pagination justify-content-center">
                        <li th:if="${requests.hasPrevious()}" class="page-item">
                            <a th:href="@{/admin/requests(page=${requests.number-1})}" class="page-link">
                                <span aria-hidden="true">&laquo;</span>
                                <span class="sr-only">Previous</span>
                            </a>
                        </li>

                        <th:block th:each="i: ${#numbers.sequence(0, requests.totalPages - 1)}">
                            <li th:if="${requests.number == i}" class="page-item active"><span
                                    class="page-link">[[${i}+1]]</span></li>
                            <li th:unless="${requests.number == i}" class="page-item">
                                <a th:href="@{/admin/requests(page=${i})}" class="page-link">[[${i}+1]]</a>
                            </li>
                        </th:block>

                        <li th:if="${requests.hasNext()}" class="page-item">
                            <a th:href="@{/admin/requests(page=${requests.number+1})}" class="page-link">
                                <span aria-hidden="true">&raquo;</span>
                                <span class="sr-only">Next</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>

</main>
<script src="/js/jquery-3.2.1.slim.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
</body>

</html>